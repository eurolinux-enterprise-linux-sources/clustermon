--- a/ricci/common/ClientSocket.cpp	2013-02-07 19:53:08.360581475 +0100
+++ b/ricci/common/ClientSocket.cpp	2013-02-07 21:31:55.744666836 +0100
@@ -1,5 +1,5 @@
 /*
-** Copyright (C) Red Hat, Inc. 2005-2011
+** Copyright Red Hat, Inc. 2013
 **
 ** This program is free software; you can redistribute it and/or modify it
 ** under the terms of the GNU General Public License version 2 as
@@ -10,10 +10,9 @@
 ** MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 ** General Public License for more details.
 **
-** You should have received a copy of the GNU General Public License
-** along with this program; see the file COPYING. If not, write to the
-** Free Software Foundation, Inc., 675 Mass Ave, Cambridge,
-** MA 02139, USA.
+** You should have received a copy of the GNU General Public License along
+** with this program; if not, write to the Free Software Foundation, Inc.,
+** 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
 */
 
 /*
@@ -181,6 +180,11 @@
 ClientSocket::operator= (const ClientSocket& s)
 {
 	if (&s != this) {
+		if (*_counter == 1 && sa_len) {
+			// if not shared with copy-constructed ClientSocket
+			free(sa_addr);
+			sa_addr = NULL;
+		}
 		this->Socket::operator= (s);
 		sa_family = s.sa_family;
 		sa_len = s.sa_len;
